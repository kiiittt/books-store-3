var D=Object.defineProperty;var P=(e,t,o)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var u=(e,t,o)=>(P(e,typeof t!="symbol"?t+"":t,o),o);import"./auth-script-24c85b55.js";import"https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";import"https://www.gstatic.com/firebasejs/9.21.0/firebase-auth.js";async function F(){const e=await fetch("https://books-backend.p.goit.global/books/top-books");if(e.ok)return await e.json();throw new Error("Error fetching books:",e.status)}async function z(){return await(await fetch("https://books-backend.p.goit.global/books/category-list")).json()}async function G(e){const t=await fetch(`https://books-backend.p.goit.global/books/category?category=${e}`);if(t.ok)return await t.json();throw new Error("Error fetching category books:",t.status)}async function _(e){const t=await fetch(`https://books-backend.p.goit.global/books/${e}`);if(t.ok)return await t.json();throw new Error("Error fetching book details:",t.status)}async function v(e){return await(await fetch(`https://books-backend.p.goit.global/books/category?category=${e}`)).json()}class w{constructor(){u(this,"spinnerEl",document.createElement("div"));u(this,"circleFirst",document.createElement("div"));u(this,"circleSecond",document.createElement("div"));u(this,"modalEl",document.querySelector(".modal"));this.spinnerEl.classList.add("spinner"),this.circleFirst.classList.add("circle","circle-1","is-hidden"),this.circleSecond.classList.add("circle","circle-2","is-hidden"),this.spinnerEl.appendChild(this.circleFirst),this.spinnerEl.appendChild(this.circleSecond),document.body.appendChild(this.spinnerEl)}show(){this.spinnerEl.classList.remove("is-hidden"),this.circleFirst.classList.remove("is-hidden"),this.circleSecond.classList.remove("is-hidden"),this.modalEl.classList.contains("is-hidden")||this.modalEl.classList.add("is-hidden")}hide(){this.spinnerEl.classList.add("is-hidden"),this.circleFirst.classList.add("is-hidden"),this.circleSecond.classList.add("is-hidden"),this.modalEl.classList.contains("is-hidden")&&this.modalEl.classList.remove("is-hidden")}getEl(){return this.spinnerEl}}const a=new w,T=document.querySelector(".bestsellers-list");let y=[];const $=async()=>{a.show();try{y=await F(),f(),C(y)}catch{console.error(error)}a.hide()};$().then(e=>{y=e,f(),C(y)}).catch(e=>console.error(e));let p=0,b=0;function f(){const e=window.innerWidth;e<768?(p=1,b=30):e>=768&&e<1440?(p=3,b=20):(p=5,b=15)}window.addEventListener("resize",()=>{x(),f(),C(y)});function C(e){if(!e||e.length===0)return;f();let t="";for(let o=0;o<e.length;o++){const s=e[o].list_name;t+=`
      <li class="bestsellers-list-item">
        <p class="bestsellers-general-category">${s}</p>
        <div class="bestsellers-book-list">`;const l=e[o].books;if(!(!l||l.length===0)){for(let r=0;r<l.length&&r!==p;r++){const n=l[r];t+=`
        <div class="bestsellers-book-item">
          <div class="test-wraper">
            <img src="${n.book_image}" alt="book-cover" class="bestsellers-book-cover" data-id="${n._id}" loading="lazy" data-modal-open>
          </div>
          <p class="bestsellers-book-title">${B(n.title,b)}</p>
          <p class="bestsellers-book-author">${n.author}</p>
        </div>`}t+=`
        </div>
        <button class="bestsellers-button" data-id="${e[o].list_name}">See more</button>
      </li>`}}T.innerHTML=t,Z()}window.addEventListener("resize",e=>{x(),f(),$()});function x(){T.innerHTML=""}function B(e,t){let o;return e.length<=t?o=e.slice(0,e.length):o=e.slice(0,t)+"...",o}const R=document.querySelector(".bestsellers-list"),E=document.querySelector(".category_books"),J=document.querySelector(".bestsellers-area"),K=document.querySelector(".category_books_container");R.addEventListener("click",U);function U(e){if(e.target.nodeName!=="BUTTON")return;const t=e.target.dataset.id;oe(t),a.show(),G(t).then(o=>{V(o,e),a.hide()}).catch(o=>{console.log(o),a.hide()})}function Y(){E.innerHTML=""}function V(e,t){J.style.display="none",K.style.display="flex",Q(t),Y(),X(e);const o=e.map(({book_image:s,title:l,author:r,_id:n})=>`<li class = "category_books_items">
          <div class="test-wraper">
          <img src='${s}' alt='book-cover' class='bestsellers-book-cover' data-id="${n}">
          </div>
             <p class='bestsellers-book-title book-text'>${B(l,15)}</p>
             <p class='bestsellers-book-author'>${r}</p></li>
      `).join("");E.insertAdjacentHTML("beforeend",o)}function Q(e){const t=document.querySelector(".category_books_title"),s=e.target.dataset.id.split(" "),l=s.at(-1),n=s.slice(0,s.length-1).join(" ");t.textContent=n;const c=document.createElement("span");c.classList="last_word_category_title",c.textContent=l,t.append(c)}function X(e){if(e.length===0){const t=document.createElement("p");t.textContent="Oops, there is no books in this category.",t.classList.add("no-books-message"),E.appendChild(t);return}}function Z(){const e=document.querySelectorAll(".bestsellers-list-item");for(let t=0;t<e.length;t+=1)e[t].addEventListener("click",ee)}const q=document.querySelector(".img-and-description"),m=document.querySelector(".btn-modal-add-js"),M="books";let i=JSON.parse(localStorage.getItem(M))||[];function ee(e){if(e.target.className!=="bestsellers-book-cover")return;const t=e.target.dataset.id;a.show(),q.innerHTML="<p>Loading...</p>",_(t).then(o=>{te(o),a.hide()}).catch(o=>{console.log(o),a.hide()})}let g=null;function te(e){q.innerHTML=`<img class="img-modal" src="${e.book_image}" alt="Image cover" />
      <div class="div-text-modal">
        <h1 class="item-modal">${e.title}</h1>
        <h3 class="autor-name-modal">${e.author}</h3>
        <p class="description-modal">${e.description}</p>
        <ul class="ul-modal">
          <li class="li-modal">
            <a href="${e.buy_links[0].url}" class="amazon-modal" target="_blank" data-book-id="${e._id}"></a>
          </li>
          <li class="li-modal">
            <a href="${e.buy_links[1].url}" class="book-modal" target="_blank" data-book-id="${e._id}"></a>
          </li>
          <li class="li-modal">
            <a href="${e.buy_links[4].url}" class="books-modal" target="_blank" data-book-id="${e._id}">
          </a></li>
        </ul>
      </div>`,g=e,i.find(t=>t._id===g._id)?(m.textContent="REMOVE FROM THE SHOPPING LIST",k.classList.remove("visually-hidden")):(m.textContent="ADD TO SHOPPING LIST",k.classList.add("visually-hidden"))}function oe(e){const t=document.querySelectorAll(".category_button"),o=document.querySelector(".category_all");t.forEach(s=>{const l=s.textContent===e;s.style.fontWeight=l?"700":"400",s.style.lineHeight=l?"1.33":"1.12",s.style.textTransform=l?"uppercase":"none",s.style.textAlign=l?"left":"",s.style.color=l?"var(--color-of-categoryAll-text)":"var(--color-of-category-text)"}),o.style.fontWeight="400",o.style.lineHeight="1.12",o.style.textTransform="none",o.style.color="var(--color-of-category-text)"}m.addEventListener("click",se);const k=document.querySelector(".under-modal-btn-text");function se(){if(i.find(e=>e._id===g._id)){const e=i.findIndex(t=>t._id===g._id);i.splice(e,1),localStorage.setItem("books",JSON.stringify(i)),m.textContent="ADD TO SHOPPING LIST",k.classList.add("visually-hidden")}else i.push(g),localStorage.setItem(M,JSON.stringify(i)),m.textContent="REMOVE FROM THE SHOPPING LIST",k.classList.remove("visually-hidden")}const d=new w,O=document.querySelector(".category_list"),L=document.querySelector(".category_books"),A=document.querySelector(".bestsellers-area"),S=document.querySelector(".category_books_container"),le=document.querySelector(".category_all");z().then(e=>ne(e)).catch(e=>console.log(e));function ne(e){const t=e.map(({list_name:o})=>`
          <li class="item-category">
            <button type = "button" class="category_button">${o}</button>
          </li>
      `).join("");O.insertAdjacentHTML("beforeend",t)}O.addEventListener("click",re);function re(e){if(e.target.className!=="category_button")return;const t=e.target.textContent;return I(t),H(),d.show(),v(e.target.textContent).then(o=>{N(o,e),d.hide()}).catch(o=>{console.log(o),d.hide()})}d.hide();function H(){L.innerHTML=""}function N(e,t){A.style.display="none",S.style.display="flex",de(t),ce(e);const o=e.map(({book_image:s,title:l,author:r,_id:n})=>`<li class = "category_books_items">
          <div class="test-wraper">
          <img src='${s}' alt='book-cover' class='bestsellers-book-cover' data-id="${n}">
          </div>
             <p class='bestsellers-book-title book-text'>${ae(l,15)}</p>
             <p class='bestsellers-book-author'>${r}</p></li>
      `).join("");L.insertAdjacentHTML("beforeend",o)}function ae(e,t){let o;return e.length<=t?o=e.slice(0,e.length):o=e.slice(0,t)+"...",o}function ce(e){if(e.length===0){const t=document.createElement("p");t.textContent="Oops, there is no books in this category.",t.classList.add("no-books-message"),L.appendChild(t);return}}le.addEventListener("click",ie);function ie(e){A.style.display="flex",S.style.display="none";const t=e.target.className;ue(t)}function de(e){const t=document.querySelector(".category_books_title"),s=e.target.textContent.split(" "),l=s.at(-1),n=s.slice(0,s.length-1).join(" ");t.textContent=n;const c=document.createElement("span");c.classList="last_word_category_title",c.textContent=l,t.append(c)}function ue(e){const t=document.querySelectorAll(".category_button"),o=document.querySelector(".category_all");t.forEach(s=>{const l=s.textContent===e;s.style.fontWeight=l?"700":"400",s.style.lineHeight=l?"1.33":"1.12",s.style.textTransform=l?"uppercase":"none",s.style.color=l?"var(--color-of-categoryAll-text)":"var(--color-of-category-text)"}),o.style.fontWeight="700",o.style.lineHeight="1.33",o.style.textTransform="uppercase",o.style.color="var(--color-of-categoryAll-text)"}function I(e){const t=document.querySelectorAll(".category_button"),o=document.querySelector(".category_all");t.forEach(s=>{const l=s.textContent===e;s.style.fontWeight=l?"700":"400",s.style.lineHeight=l?"1.33":"1.12",s.style.textTransform=l?"uppercase":"none",s.style.textAlign=l?"left":"",s.style.color=l?"var(--color-of-categoryAll-text)":"var(--color-of-category-text)"}),o.style.fontWeight="400",o.style.lineHeight="1.12",o.style.textTransform="none",o.style.color="var(--color-of-category-text)"}const ge=document.querySelector(".bestsellers-list");document.querySelector(".bestsellers-general-category");ge.addEventListener("click",ye);function ye(e){if(e.target.className!=="bestsellers-general-category")return;const t=e.target.textContent;return I(t),H(),v(e.target.textContent).then(o=>N(o,e)).catch(o=>console.log(o))}document.querySelector(".svg-close");const me=document.querySelector("[data-modal]");S.addEventListener("click",he);function he(e){e.target.className==="bestsellers-book-cover"&&me.classList.toggle("is-hidden")}document.querySelectorAll(".bestsellers-list-item");L.addEventListener("click",fe);const j=document.querySelector(".img-and-description");function fe(e){if(e.target.className!=="bestsellers-book-cover")return;d.show();const t=e.target.dataset.id;j.innerHTML="<p>Loading...</p>",_(t).then(o=>{pe(o),d.hide()}).catch(o=>{console.log(o),d.hide()})}function pe(e){j.innerHTML=`<img class="img-modal" src="${e.book_image}" alt="Image cover" />
      <div class="div-text-modal">
        <h1 class="item-modal">${e.title}</h1>
        <h3 class="autor-name-modal">${e.author}</h3>
        <p class="description-modal">${e.description}</p>
        <ul class="ul-modal">
          <li class="li-modal">
          <a href="${e.buy_links[0].url}" class="amazon-modal" target="_blank"></a>
          </li>
          <li class="li-modal">
          <a href="${e.buy_links[1].url}" class="book-modal" target="_blank"></a>
          </li>
          <li class="li-modal">
          <a href="${e.buy_links[4].url}" class="books-modal" target="_blank">
          </a></li>
        </ul>
      </div>`}(()=>{const e={openModalBtn:document.querySelector(".bestsellers-area"),openModal:document.querySelector(".category_books_container"),closeModalBtn:document.querySelector("[data-modal-close]"),modal:document.querySelector("[data-modal]")};e.openModalBtn.addEventListener("click",t),e.closeModalBtn.addEventListener("click",o),window.addEventListener("keydown",s);function t(l){l.target.className==="bestsellers-book-cover"&&e.modal.classList.toggle("is-hidden")}function o(){e.modal.classList.toggle("is-hidden")}function s(l){l.key==="Escape"&&e.modal.classList.add("is-hidden")}})();const be=document.querySelector(".container"),h=document.createElement("div");h.classList.add("scroll-up_hidden");const ke=()=>{const e=window.pageYOffset,t=document.documentElement.clientHeight;e>t?h.classList.add("scroll-up"):h.classList.remove("scroll-up")},W=()=>{window.pageYOffset>0&&(window.scrollBy(0,-65),setTimeout(W,0))};h.addEventListener("click",W);window.addEventListener("scroll",ke);be.appendChild(h);
